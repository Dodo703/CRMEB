(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-bc85f9a0"],{"1dc9":function(t,e,s){"use strict";var n=s("ffcb"),i=s.n(n);i.a},2316:function(t,e,s){},"563c":function(t,e,s){t.exports=s.p+"h5/img/noAddress.d76a1cef.png"},"5f10":function(t,e,s){t.exports=s.p+"h5/img/noCoupon.e524084b.png"},"6c69":function(t,e,s){"use strict";s.r(e);var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"order-submission"},[s("div",{staticClass:"allAddress",style:t.store_self_mention?"":"padding-top: 0.2rem"},[s("div",{staticClass:"nav acea-row"},[t.store_self_mention?s("div",{staticClass:"item font-color-red",class:0===t.shipping_type?"on":"on2",on:{click:function(e){return t.addressType(0)}}}):t._e()]),0===t.shipping_type?s("div",{staticClass:"address acea-row row-between-wrapper",on:{click:t.addressTap}},[t.addressInfo.real_name?s("div",{staticClass:"addressCon"},[s("div",{staticClass:"name"},[t._v("\n          "+t._s(t.addressInfo.real_name)+"\n          "),s("span",{staticClass:"phone"},[t._v(t._s(t.addressInfo.phone))])]),s("div",[t.addressInfo.is_default?s("span",{staticClass:"default font-color-red"},[t._v("[默认]")]):t._e(),t._v("\n          "+t._s(t.addressInfo.province)+t._s(t.addressInfo.city)+t._s(t.addressInfo.district)+t._s(t.addressInfo.detail)+"\n        ")])]):s("div",{staticClass:"addressCon"},[s("div",{staticClass:"setaddress"},[t._v("设置收货地址")])]),s("div",{staticClass:"iconfont icon-jiantou"})]):s("div",{staticClass:"address acea-row row-between-wrapper"},[s("div",{staticClass:"addressCon"},[s("div",{staticClass:"name"},[t._v("\n          "+t._s(t.system_store.name)+"\n          "),s("span",{staticClass:"phone"},[t._v(t._s(t.system_store.phone))])]),s("div",[t._v("\n          "+t._s(t.system_store._detailed_address)+"\n        ")])])]),t._m(0)]),s("OrderGoods",{attrs:{evaluate:0,cartInfo:t.orderGroupInfo.cartInfo}}),s("div",{staticClass:"wrapper"},[s("div",{staticClass:"item"},[s("div",[t._v("备注信息")]),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.mark,expression:"mark"}],attrs:{placeholder:"请添加备注（150字以内）"},domProps:{value:t.mark},on:{input:function(e){e.target.composing||(t.mark=e.target.value)}}})])]),s("div",{staticClass:"moneyList"},[void 0!==t.orderPrice.total_price?s("div",{staticClass:"item acea-row row-between-wrapper"},[s("div",[t._v("商品总价：")]),s("div",{staticClass:"money"},[t._v("￥"+t._s(t.orderPrice.total_price))])]):t._e(),t.orderPrice.pay_postage>0?s("div",{staticClass:"item acea-row row-between-wrapper"},[s("div",[t._v("运费：")]),s("div",{staticClass:"money"},[t._v("￥"+t._s(t.orderPrice.pay_postage))])]):t._e(),t.orderPrice.coupon_price>0?s("div",{staticClass:"item acea-row row-between-wrapper"},[s("div",[t._v("优惠券抵扣：")]),s("div",{staticClass:"money"},[t._v("-￥"+t._s(t.orderPrice.coupon_price))])]):t._e(),t.orderPrice.deduction_price>0?s("div",{staticClass:"item acea-row row-between-wrapper"},[s("div",[t._v("积分抵扣：")]),s("div",{staticClass:"money"},[t._v("-￥"+t._s(t.orderPrice.deduction_price))])]):t._e()]),s("div",{staticStyle:{height:"1.2rem"}}),s("div",{staticClass:"footer acea-row row-between-wrapper"},[s("div",[t._v("\n      合计:\n      "),s("span",{staticClass:"font-color-red"},[t._v("￥"+t._s(t.orderPrice.pay_price))])]),s("div",{staticClass:"settlement",on:{click:t.createOrder}},[t._v("立即下单")])]),s("CouponListWindow",{attrs:{price:t.orderPrice.total_price,checked:t.usableCoupon.id},on:{couponchange:function(e){return t.changecoupon(e)},checked:t.changeCoupon},model:{value:t.showCoupon,callback:function(e){t.showCoupon=e},expression:"showCoupon"}}),s("AddressWindow",{ref:"mychild",attrs:{checked:t.addressInfo.id},on:{checked:t.changeAddress,redirect:t.addressRedirect},model:{value:t.showAddress,callback:function(e){t.showAddress=e},expression:"showAddress"}})],1)},i=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"line"},[n("img",{attrs:{src:s("afa3")}})])}],o=(s("a481"),s("7f7f"),s("713c")),r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"coupon-list-window",class:!0===t.value?"on":""},[s("div",{staticClass:"title"},[t._v("\n      优惠券\n      "),s("span",{staticClass:"iconfont icon-guanbi",on:{click:t.close}})]),t.couponList.length>0?s("div",[s("div",{staticClass:"coupon-list"},t._l(t.couponList,function(e){return s("div",{key:e.id,staticClass:"item acea-row row-center-wrapper",on:{click:function(s){return t.click(e)}}},[s("div",{staticClass:"money"},[t._v("\n            ￥\n            "),s("span",{staticClass:"num"},[t._v(t._s(e.coupon_price))])]),s("div",{staticClass:"text"},[s("div",{staticClass:"condition line1"},[t._v(t._s(e.coupon_title))]),s("div",{staticClass:"data acea-row row-between-wrapper"},[s("div",[t._v("\n                "+t._s(e.start_time?e.start_time+"-":"")+t._s(e.end_time)+"\n              ")]),t.checked===e.id?s("div",{staticClass:"iconfont icon-xuanzhong1 font-color-red"}):s("div",{staticClass:"iconfont icon-weixuanzhong"})])])])}),0),s("div",{staticClass:"couponNo bg-color-red",on:{click:t.couponNo}},[t._v("不使用优惠券")])]):t._e(),!t.couponList.length&&t.loaded?s("div",[t._m(0)]):t._e()]),s("div",{staticClass:"mask",attrs:{hidden:!1===t.value},on:{touchmove:function(t){t.preventDefault()},click:t.close}})])},a=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pictrue"},[n("img",{staticClass:"image",attrs:{src:s("5f10")}})])}],c=(s("c5f6"),s("f8b7")),d={name:"CouponListWindow",props:{value:Boolean,checked:Number,price:{type:[Number,String],default:void 0}},data:function(){return{couponList:[],loaded:!1}},watch:{price:function(t){void 0!==t&&null!=t&&this.getCoupon()}},mounted:function(){},methods:{close:function(){this.$emit("input",!1),this.$emit("close")},getCoupon:function(){var t=this;Object(c["e"])(this.price).then(function(e){t.couponList=e.data,t.loaded=!0})},click:function(t){this.$emit("checked",t),this.$emit("input",!1)},couponNo:function(){this.$emit("checked",null),this.$emit("input",!1)}}},u=d,l=(s("1dc9"),s("2877")),p=Object(l["a"])(u,r,a,!1,null,"71d8c8b6",null),f=p.exports,h=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"address-window",class:!0===t.value?"on":""},[n("div",{staticClass:"title"},[t._v("\n      选择地址"),n("span",{staticClass:"iconfont icon-guanbi",on:{click:t.closeAddress}})]),t.addressList.length?n("div",{staticClass:"list"},t._l(t.addressList,function(e,s){return n("div",{key:s,staticClass:"item acea-row row-between-wrapper",class:e.id===t.checked?"font-color-red":"",on:{click:function(e){return t.tapAddress(s)}}},[n("span",{staticClass:"iconfont icon-ditu",class:e.id===t.checked?"font-color-red":""}),n("div",{staticClass:"addressTxt"},[n("div",{staticClass:"name",class:e.id===t.checked?"font-color-red":""},[t._v("\n            "+t._s(e.real_name)),n("span",{staticClass:"phone"},[t._v(t._s(e.phone))])]),n("div",{staticClass:"line1"},[t._v("\n            "+t._s(e.province)+t._s(e.city)+t._s(e.district)+t._s(e.detail)+"\n          ")])]),n("span",{staticClass:"iconfont icon-complete",class:e.id===t.checked?"font-color-red":""})])}),0):t._e(),t.addressList.length<1?n("div",{staticClass:"pictrue"},[n("img",{staticClass:"image",attrs:{src:s("563c")}})]):t._e(),n("div",{staticClass:"addressBnt bg-color-red",on:{click:t.goAddressPages}},[t._v("\n      新加地址\n    ")])]),n("div",{staticClass:"mask",attrs:{hidden:!1===t.value},on:{touchmove:function(t){t.preventDefault()},click:t.closeAddress}})])},_=[],v=s("c24f"),m={name:"AddressWindow",props:{value:Boolean,checked:Number},data:function(){return{addressList:[],current:0,cartId:0,pinkId:0,couponId:0}},mounted:function(){},methods:{getAddressList:function(){var t=this;Object(v["f"])().then(function(e){t.addressList=e.data})},closeAddress:function(){this.$emit("input",!1)},goAddressPages:function(){this.$router.push({path:"/user/add_address"}),this.$emit("redirect")},tapAddress:function(t){this.$emit("checked",this.addressList[t]),this.$emit("input",!1)}}},C=m,g=Object(l["a"])(C,h,_,!1,null,null,null),w=g.exports,I=s("74f9"),b=s("ed08"),k="OrderSubmission",y=Object(b["d"])(),$={name:k,components:{OrderGoods:o["a"],CouponListWindow:f,AddressWindow:w},props:{},data:function(){return{offlinePayStatus:2,from:y?"weixin":"weixinh5",deduction:!0,isWeixin:y,pinkId:0,active:"cod",showCoupon:!1,showAddress:!1,addressInfo:{},couponId:0,orderGroupInfo:{priceGroup:{}},usableCoupon:{},addressLoaded:!1,useIntegral:!1,orderPrice:{pay_price:"计算中"},mark:"",system_store:{},shipping_type:0,contacts:"",contactsTel:"",store_self_mention:0,userInfo:{}}},watch:{useIntegral:function(){this.computedPrice()},$route:function(t){t.name===k&&(this.getUserInfo(),this.getCartInfo())},shipping_type:function(){this.computedPrice()}},mounted:function(){var t=this;t.getUserInfo(),t.getCartInfo(),void 0!==t.$route.query.pinkid&&(t.pinkId=t.$route.query.pinkid)},methods:{getUserInfo:function(){var t=this;Object(v["D"])().then(function(e){t.userInfo=e.data}).catch(function(){})},addressType:function(t){if(t&&!this.system_store.id)return this.$dialog.error("暂无门店信息，您无法选择到店自提！");this.shipping_type=t},computedPrice:function(){var t=this,e=this.shipping_type;Object(c["k"])(this.orderGroupInfo.orderKey,{addressId:this.addressInfo.id,useIntegral:this.useIntegral?1:0,couponId:this.usableCoupon.id||0,shipping_type:parseInt(e)+1}).then(function(e){var s=e.data;"EXTEND_ORDER"===s.status?t.$router.replace({path:"/user"}):t.orderPrice=s.result})},getCartInfo:function(){var t=this,e=this.$route.params.id;if(!e)return this.$dialog.error("参数有误"),this.$router.go(-1);Object(c["l"])(e).then(function(e){t.offlinePayStatus=e.data.offline_pay_status,t.orderGroupInfo=e.data,t.deduction=e.data.deduction,t.usableCoupon=e.data.usableCoupon||{},t.addressInfo=e.data.addressInfo||{},t.system_store=e.data.system_store||{},t.store_self_mention=e.data.store_self_mention,t.computedPrice()}).catch(function(){t.$dialog.error("加载订单数据失败")})},addressTap:function(){this.showAddress=!0,this.addressLoaded||(this.addressLoaded=!0,this.$refs.mychild.getAddressList())},addressRedirect:function(){this.addressLoaded=!1,this.showAddress=!1},couponTap:function(){this.showCoupon=!0},changeCoupon:function(t){this.usableCoupon=t||{coupon_title:"不使用优惠券",id:0},this.computedPrice()},payItem:function(t){this.active=t},changeAddress:function(t){this.addressInfo=t},createOrder:function(){var t=this,e=this.shipping_type;return this.addressInfo.id||this.shipping_type?this.shipping_type&&(""===this.contacts||""===this.contactsTel)&&this.shipping_type?this.$dialog.toast({mes:"请填写联系人或联系人电话"}):(this.$dialog.loading.open("生成订单中"),void Object(c["b"])(this.orderGroupInfo.orderKey,{real_name:this.contacts,phone:this.contactsTel,addressId:this.addressInfo.id,useIntegral:this.useIntegral?1:0,couponId:this.usableCoupon.id||0,payType:"cod",pinkId:this.pinkId,seckill_id:this.orderGroupInfo.seckill_id,combinationId:this.orderGroupInfo.combination_id,bargainId:this.orderGroupInfo.bargain_id,from:this.from,mark:this.mark||"",shipping_type:parseInt(e)+1}).then(function(e){t.$dialog.loading.close();var s=e.data,n="/order/status/"+s.result.orderId;switch(s.status){case"ORDER_EXIST":case"EXTEND_ORDER":case"PAY_DEFICIENCY":case"PAY_ERROR":t.$router.replace({path:"/user"});break;case"SUCCESS":t.$dialog.success(e.msg),t.$router.replace({path:n+"/1"});break;case"WECHAT_H5_PAY":t.$router.replace({path:n+"/2"}),setTimeout(function(){location.href=s.result.jsConfig.mweb_url},100);break;case"WECHAT_PAY":Object(I["pay"])(s.result.jsConfig).finally(function(){t.$router.replace({path:n+"/4"})})}}).catch(function(e){console.log(e),t.$dialog.loading.close(),t.$dialog.success("下单成功"),t.$router.replace({path:"/order/list/0"})})):this.$dialog.toast({mes:"请选择收货地址"})}}},A=$,P=(s("c56f"),Object(l["a"])(A,n,i,!1,null,"2eb062bf",null));e["default"]=P.exports},"713c":function(t,e,s){"use strict";var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"orderGoods"},[s("div",{staticClass:"total"},[t._v("共"+t._s(t.cartInfo.length)+"件商品")]),s("div",{staticClass:"goodWrapper"},t._l(t.cartInfo,function(e){return s("div",{key:e.id,staticClass:"item acea-row row-between-wrapper"},[s("div",{staticClass:"pictrue"},[s("img",{staticClass:"image",attrs:{src:e.productInfo.image}})]),s("div",{staticClass:"text"},[s("div",{staticClass:"acea-row row-between-wrapper"},[s("div",{staticClass:"name line1"},[t._v(t._s(e.productInfo.store_name))]),s("div",{staticClass:"num"},[t._v("x "+t._s(e.cart_num))])]),e.productInfo.attrInfo?s("div",{staticClass:"attr line1"},[t._v("\n          "+t._s(e.productInfo.attrInfo.suk)+"\n        ")]):t._e(),s("div",{staticClass:"money font-color-red"},[t._v("￥"+t._s(e.truePrice))]),3===t.evaluate?s("div",{staticClass:"evaluate",on:{click:function(s){return t.$router.push({path:"/goods_evaluate/"+e.unique})}}},[t._v("\n          评价\n        ")]):t._e()])])}),0)])},i=[],o=(s("c5f6"),{name:"OrderGoods",props:{evaluate:Number,cartInfo:{type:Array,default:function(){return[]}}},data:function(){return{}},mounted:function(){},methods:{}}),r=o,a=s("2877"),c=Object(a["a"])(r,n,i,!1,null,null,null);e["a"]=c.exports},afa3:function(t,e,s){t.exports=s.p+"h5/img/line.05bf1c84.jpg"},c56f:function(t,e,s){"use strict";var n=s("2316"),i=s.n(n);i.a},f8b7:function(t,e,s){"use strict";s.d(e,"l",function(){return i}),s.d(e,"k",function(){return o}),s.d(e,"e",function(){return r}),s.d(e,"b",function(){return a}),s.d(e,"f",function(){return c}),s.d(e,"g",function(){return d}),s.d(e,"a",function(){return u}),s.d(e,"i",function(){return l}),s.d(e,"h",function(){return p}),s.d(e,"m",function(){return f}),s.d(e,"n",function(){return h}),s.d(e,"c",function(){return _}),s.d(e,"d",function(){return v}),s.d(e,"j",function(){return m});var n=s("b775");function i(t){return n["a"].post("/order/confirm",{cartId:t})}function o(t,e){return n["a"].post("/order/computed/"+t,e)}function r(t){return n["a"].get("/coupons/order/"+(parseFloat(t)||0))}function a(t,e){return n["a"].post("/order/create/"+t,e||{})}function c(){return n["a"].get("/order/data")}function d(t){return n["a"].get("/order/list",t)}function u(t){return n["a"].post("/order/cancel",{id:t})}function l(t){return n["a"].get("/order/detail/"+t)}function p(){return n["a"].get("/order/refund/reason")}function f(t){return n["a"].post("/order/refund/verify",t)}function h(t){return n["a"].post("/order/take",{uni:t})}function _(t){return n["a"].post("/order/del",{uni:t})}function v(t){return n["a"].get("order/express/"+t)}function m(t,e,s){return n["a"].post("order/pay",{uni:t,paytype:e,from:s})}},ffcb:function(t,e,s){}}]);
//# sourceMappingURL=chunk-bc85f9a0.275ab580.js.map